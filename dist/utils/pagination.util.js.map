{"version":3,"sources":["../../src/utils/pagination.util.ts"],"sourcesContent":["export interface PaginatedResult<T> {\n  data: T[]\n  meta: {\n    total: number\n    lastPage: number\n    current: number\n    perPage: number\n    prev: number | null\n    next: number | null\n  }\n}\n\nexport type PaginateOptions = { page?: number | string; perPage?: number | string }\nexport type PaginateFunction = <T, K>(\n  model: any,\n  args?: K,\n  options?: PaginateOptions,\n) => Promise<PaginatedResult<T>>\n\nexport const createPaginator = (defaultOptions: PaginateOptions): PaginateFunction => {\n  return async (model, args: any = { where: undefined }, options) => {\n    const page = Number(options?.page || defaultOptions?.page) || 1\n    const perPage = Number(options?.perPage || defaultOptions?.perPage) || 10\n\n    const skip = page > 0 ? perPage * (page - 1) : 0\n\n    const [total, data] = await Promise.all([\n      model.count({ where: args.where }),\n      model.findMany({\n        ...args,\n        take: perPage,\n        skip,\n      }),\n    ])\n\n    const lastPage = Math.ceil(total / perPage)\n\n    return {\n      data,\n      meta: {\n        total,\n        lastPage,\n        current: page,\n        perPage,\n        prev: page > 1 ? page - 1 : null,\n        next: page < lastPage ? page + 1 : null,\n      },\n    }\n  }\n}\n"],"names":["createPaginator","defaultOptions","model","args","where","undefined","options","page","Number","perPage","skip","total","data","Promise","all","count","findMany","take","lastPage","Math","ceil","meta","current","prev","next"],"mappings":";;;;+BAmBaA;;;eAAAA;;;AAAN,MAAMA,kBAAkB,CAACC;IAC9B,OAAO,OAAOC,OAAOC,OAAY;QAAEC,OAAOC;IAAU,CAAC,EAAEC;QACrD,MAAMC,OAAOC,OAAOF,SAASC,QAAQN,gBAAgBM,SAAS;QAC9D,MAAME,UAAUD,OAAOF,SAASG,WAAWR,gBAAgBQ,YAAY;QAEvE,MAAMC,OAAOH,OAAO,IAAIE,UAAWF,CAAAA,OAAO,CAAA,IAAK;QAE/C,MAAM,CAACI,OAAOC,KAAK,GAAG,MAAMC,QAAQC,GAAG,CAAC;YACtCZ,MAAMa,KAAK,CAAC;gBAAEX,OAAOD,KAAKC,KAAK;YAAC;YAChCF,MAAMc,QAAQ,CAAC;gBACb,GAAGb,IAAI;gBACPc,MAAMR;gBACNC;YACF;SACD;QAED,MAAMQ,WAAWC,KAAKC,IAAI,CAACT,QAAQF;QAEnC,OAAO;YACLG;YACAS,MAAM;gBACJV;gBACAO;gBACAI,SAASf;gBACTE;gBACAc,MAAMhB,OAAO,IAAIA,OAAO,IAAI;gBAC5BiB,MAAMjB,OAAOW,WAAWX,OAAO,IAAI;YACrC;QACF;IACF;AACF"}